<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warframe Daily Checklist</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #00d4ff;
            margin-bottom: 20px;
            font-size: 2rem;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
        }

        .stat {
            text-align: center;
            color: #00d4ff;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }

        .timer-compact {
            background: rgba(0, 0, 0, 0.4);
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            font-size: 0.85rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .timer-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .timer-label {
            font-weight: bold;
            color: #00d4ff;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 20px;
        }

        .daily-tasks {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            border-left: 3px solid #ff4757;
        }

        .weekly-sidebar {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            border-left: 3px solid #ffa502;
            max-height: 70vh;
            overflow-y: auto;
        }

        .section-title {
            color: #00d4ff;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .task-category {
            margin-bottom: 20px;
        }

        .category-title {
            color: #ffa502;
            font-size: 1rem;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid rgba(255, 165, 2, 0.3);
        }

        .task-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            border: 1px solid transparent;
        }

        .task-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .task-checkbox {
            width: 16px;
            height: 16px;
            margin-right: 10px;
            cursor: pointer;
        }

        .task-label {
            flex: 1;
            cursor: pointer;
            user-select: none;
        }

        .task-actions {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .ignore-btn {
            background: transparent;
            border: 1px solid #ff4757;
            color: #ff4757;
            border-radius: 3px;
            width: 20px;
            height: 20px;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ignore-btn:hover {
            background: rgba(255, 71, 87, 0.2);
        }

        .counter {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
        }

        .counter-btn {
            background: rgba(0, 212, 255, 0.2);
            border: 1px solid rgba(0, 212, 255, 0.5);
            color: #00d4ff;
            border-radius: 3px;
            width: 18px;
            height: 18px;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .counter-btn:hover {
            background: rgba(0, 212, 255, 0.4);
        }

        /* Task states */
        .task-item.completed {
            opacity: 0.7;
            text-decoration: line-through;
            background: rgba(45, 213, 115, 0.1);
        }

        .task-item.ignored {
            opacity: 0.5;
            text-decoration: line-through;
            background: rgba(255, 71, 87, 0.1);
        }

        .ignore-btn.ignored {
            background: rgba(255, 71, 87, 0.3);
        }

        /* Priority indicators */
        .priority-high { border-left-color: #ff4757 !important; }
        .priority-medium { border-left-color: #ffa502 !important; }
        .priority-low { border-left-color: #2ed573 !important; }

        /* Weekly task styling */
        .weekly-task-item {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }

        .weekly-task-item:hover {
            background: rgba(255, 255, 255, 0.06);
        }

        .weekly-task-item .task-checkbox {
            width: 14px;
            height: 14px;
            margin-right: 8px;
        }

        .weekly-task-item .ignore-btn {
            width: 16px;
            height: 16px;
            font-size: 8px;
        }

        /* Control buttons */
        .control-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .reset-btn {
            background: linear-gradient(135deg, #ff4757, #ff6b7a);
            color: white;
        }

        .auto-check-btn {
            background: linear-gradient(135deg, #2ed573, #7bed9f);
            color: white;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .weekly-sidebar {
                max-height: none;
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .task-grid {
                grid-template-columns: 1fr;
            }
            
            .timer-compact {
                grid-template-columns: 1fr;
                font-size: 0.8rem;
            }
        }

        /* Scrollbar styling */
        .weekly-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .weekly-sidebar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        .weekly-sidebar::-webkit-scrollbar-thumb {
            background: rgba(0, 212, 255, 0.3);
            border-radius: 3px;
        }

        .weekly-sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 212, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>⚡ WARFRAME DAILY CHECKLIST ⚡</h1>
        
        <div class="quick-stats">
            <div class="stat">
                <span class="stat-value" id="daily-progress">0%</span>
                <span>Daily Complete</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="weekly-progress">0%</span>
                <span>Weekly Complete</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="completed-tasks">0</span>
                <span>Tasks Done</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="streak-counter">0</span>
                <span>Day Streak</span>
            </div>
        </div>

        <div class="timer-compact">
            <div class="timer-item">
                <span class="timer-label">Daily Reset:</span>
                <span id="daily-reset">--</span>
            </div>
            <div class="timer-item">
                <span class="timer-label">Weekly Reset:</span>
                <span id="weekly-reset">--</span>
            </div>
            <div class="timer-item">
                <span class="timer-label">Baro Ki'Teer:</span>
                <span><span id="baro-status">--</span> <span id="baro-timer">--</span></span>
            </div>
            <div class="timer-item">
                <span class="timer-label">Eleanor:</span>
                <span><span id="eleanor-status">--</span> | <span id="eleanor-timer">--</span></span>
            </div>
        </div>

        <div class="main-layout">
            <div class="daily-tasks">
                <h2 class="section-title">🔥 Daily Tasks</h2>
                
                <div class="task-category">
                    <div class="category-title">Essential (High Priority)</div>
                    <div class="task-grid" id="essential-tasks">
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="daily-login">
                            <label for="daily-login" class="task-label">Daily Login Reward</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="daily-login">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="sortie">
                            <label for="sortie" class="task-label">Daily Sortie</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="sortie">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="syndicate-daily">
                            <label for="syndicate-daily" class="task-label">Syndicate Missions</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="syndicate-daily">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="focus-cap">
                            <label for="focus-cap" class="task-label">Focus Cap (250K+)</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="focus-cap">✕</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Combat & Farming</div>
                    <div class="task-grid" id="combat-tasks">
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="steel-path">
                            <label for="steel-path" class="task-label">Steel Path Incursions</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="steel-path">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="arbitrations">
                            <label for="arbitrations" class="task-label">Arbitrations</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="arbitrations">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="relic-farming">
                            <label for="relic-farming" class="task-label">Open Prime Relics</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="relic-farming">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="lich-sister">
                            <label for="lich-sister" class="task-label">Lich/Sister Progress</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="lich-sister">✕</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Main Syndicates</div>
                    <div class="task-grid" id="main-syndicates">
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="steel-meridian">
                            <label for="steel-meridian" class="task-label">Steel Meridian</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="steel-meridian">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="arbiters-hexis">
                            <label for="arbiters-hexis" class="task-label">Arbiters of Hexis</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="arbiters-hexis">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="cephalon-suda">
                            <label for="cephalon-suda" class="task-label">Cephalon Suda</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="cephalon-suda">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="perrin-sequence">
                            <label for="perrin-sequence" class="task-label">Perrin Sequence</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="perrin-sequence">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="red-veil">
                            <label for="red-veil" class="task-label">Red Veil</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="red-veil">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="new-loka">
                            <label for="new-loka" class="task-label">New Loka</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="new-loka">✕</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Open World Syndicates</div>
                    <div class="task-grid" id="open-world-syndicates">
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="ostron">
                            <label for="ostron" class="task-label">Ostron (Cetus)</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="ostron">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="solaris-united">
                            <label for="solaris-united" class="task-label">Solaris United</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="solaris-united">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="entrati">
                            <label for="entrati" class="task-label">Entrati (Deimos)</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="entrati">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="holdfasts">
                            <label for="holdfasts" class="task-label">The Holdfasts</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="holdfasts">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="cavia">
                            <label for="cavia" class="task-label">Cavia</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="cavia">✕</button>
                            </div>
                        </div>
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" id="the-hex">
                            <label for="the-hex" class="task-label">The Hex</label>
                            <div class="task-actions">
                                <button class="ignore-btn" data-task="the-hex">✕</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="weekly-sidebar">
                <h2 class="section-title">📅 Weekly Tasks</h2>
                
                <div class="task-category">
                    <div class="category-title">Core Weekly</div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="nightwave">
                        <label for="nightwave" class="task-label">Nightwave Challenges</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="nightwave">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="archon-hunt">
                        <label for="archon-hunt" class="task-label">Archon Hunt</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="archon-hunt">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="maroo-treasure">
                        <label for="maroo-treasure" class="task-label">Ayatan Hunt (Maroo)</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="maroo-treasure">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="help-clem">
                        <label for="help-clem" class="task-label">Help Clem</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="help-clem">✕</button>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Circuit & Activities</div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="duviri-circuit">
                        <label for="duviri-circuit" class="task-label">Duviri Circuit</label>
                        <div class="task-actions">
                            <div class="counter">
                                <button class="counter-btn" data-task="duviri-circuit" data-action="minus">-</button>
                                <span id="duviri-count">0</span>/10
                                <button class="counter-btn" data-task="duviri-circuit" data-action="plus">+</button>
                            </div>
                            <button class="ignore-btn" data-task="duviri-circuit">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="sp-circuit">
                        <label for="sp-circuit" class="task-label">Steel Path Circuit</label>
                        <div class="task-actions">
                            <div class="counter">
                                <button class="counter-btn" data-task="sp-circuit" data-action="minus">-</button>
                                <span id="sp-count">0</span>/10
                                <button class="counter-btn" data-task="sp-circuit" data-action="plus">+</button>
                            </div>
                            <button class="ignore-btn" data-task="sp-circuit">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="kahl-mission">
                        <label for="kahl-mission" class="task-label">Kahl Mission</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="kahl-mission">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="netracells">
                        <label for="netracells" class="task-label">Netracells (5x)</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="netracells">✕</button>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Elite Weekly</div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="elite-archimedea">
                        <label for="elite-archimedea" class="task-label">Elite Archimedea</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="elite-archimedea">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="steel-path-honors">
                        <label for="steel-path-honors" class="task-label">SP Honors (25)</label>
                        <div class="task-actions">
                            <div class="counter">
                                <button class="counter-btn" data-task="steel-path-honors" data-action="minus">-</button>
                                <span id="sp-honors-count">0</span>/25
                                <button class="counter-btn" data-task="steel-path-honors" data-action="plus">+</button>
                            </div>
                            <button class="ignore-btn" data-task="steel-path-honors">✕</button>
                        </div>
                    </div>
                </div>

                <div class="task-category">
                    <div class="category-title">Vendor Visits</div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="palladino-riven">
                        <label for="palladino-riven" class="task-label">Palladino (Riven)</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="palladino-riven">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="yonta-kuva">
                        <label for="yonta-kuva" class="task-label">Yonta (Kuva)</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="yonta-kuva">✕</button>
                        </div>
                    </div>
                    <div class="weekly-task-item">
                        <input type="checkbox" class="task-checkbox" id="bird3-shard">
                        <label for="bird3-shard" class="task-label">Bird 3 (Shard)</label>
                        <div class="task-actions">
                            <button class="ignore-btn" data-task="bird3-shard">✕</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-bar">
            <button class="control-btn auto-check-btn" onclick="autoCheckEssentials()">✓ Check Essentials</button>
            <button class="control-btn reset-btn" onclick="resetChecklist()">🔄 Reset All</button>
        </div>
    </div>

    <script>
        // Game state stored in memory
        let gameState = {
            tasks: {},
            ignored: {},
            counters: {
                duviri: 0,
                sp: 0,
                spHonors: 0
            },
            streak: parseInt(sessionStorage.getItem('warframe-streak') || '0'),
            lastCompleteDate: sessionStorage.getItem('warframe-last-complete')
        };

        // Timer management
        function updateTimers() {
            const now = new Date();
            
            // Daily reset at 00:00 UTC
            let dailyReset = new Date();
            dailyReset.setUTCHours(24, 0, 0, 0);
            
            // Weekly reset Monday 00:00 UTC
            let weeklyReset = new Date();
            const daysUntilMonday = (8 - now.getUTCDay()) % 7;
            weeklyReset.setUTCDate(now.getUTCDate() + daysUntilMonday);
            weeklyReset.setUTCHours(0, 0, 0, 0);
            if (daysUntilMonday === 0 && now.getUTCHours() >= 0) {
                weeklyReset.setUTCDate(weeklyReset.getUTCDate() + 7);
            }

            // Baro Ki'Teer calculation (every 2 weeks, Friday-Sunday)
            const baroRef = new Date('2025-01-17T00:00:00.000Z');
            const daysSinceRef = Math.floor((now - baroRef) / (1000 * 60 * 60 * 24));
            const cyclePos = daysSinceRef % 14;
            
            let baroNext, baroStatus;
            if (cyclePos < 0) {
                baroNext = new Date(baroRef);
                baroStatus = "Arriving";
            } else if (cyclePos < 2) {
                baroNext = new Date(baroRef);
                baroNext.setUTCDate(baroRef.getUTCDate() + Math.floor(daysSinceRef / 14) * 14 + 2);
                baroStatus = "Leaving";
            } else {
                baroNext = new Date(baroRef);
                baroNext.setUTCDate(baroRef.getUTCDate() + (Math.floor(daysSinceRef / 14) + 1) * 14);
                baroStatus = "Arriving";
            }

            // Eleanor calculation (4-day cycles)
            const eleanorRef = new Date('2025-08-16T00:00:00.000Z');
            const daysSinceEleanor = Math.floor((now - eleanorRef) / (1000 * 60 * 60 * 24));
            const eleanorCycleDay = daysSinceEleanor % 4;
            let eleanorNext = new Date();
            eleanorNext.setUTCDate(now.getUTCDate() + (4 - eleanorCycleDay) % 4);
            eleanorNext.setUTCHours(0, 0, 0, 0);
            
            const eleanorBatches = ["Batch A", "Batch B"];
            const currentEleanorBatch = eleanorBatches[Math.floor(daysSinceEleanor / 4) % 2];

            updateTimerDisplay(dailyReset, weeklyReset, baroNext, baroStatus, eleanorNext, currentEleanorBatch);
        }

        function updateTimerDisplay(dailyReset, weeklyReset, baroNext, baroStatus, eleanorNext, eleanorBatch) {
            const now = new Date();
            
            document.getElementById('daily-reset').textContent = formatTime(dailyReset - now);
            document.getElementById('weekly-reset').textContent = formatTime(weeklyReset - now);
            document.getElementById('baro-status').textContent = baroStatus;
            document.getElementById('baro-timer').textContent = formatTime(baroNext - now);
            document.getElementById('eleanor-status').textContent = eleanorBatch;
            document.getElementById('eleanor-timer').textContent = formatTime(eleanorNext - now);
        }

        function formatTime(ms) {
            if (ms < 0) ms = 0;
            const hours = Math.floor(ms / (1000 * 60 * 60));
            const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));
            
            if (hours >= 24) {
                const days = Math.floor(hours / 24);
                const remainingHours = hours % 24;
                return `${days}d ${remainingHours}h`;
            }
            return `${hours}h ${minutes}m`;
        }

        // Task management
        function updateProgress() {
            const allDaily = document.querySelectorAll('.daily-tasks .task-checkbox');
            const allWeekly = document.querySelectorAll('.weekly-sidebar .task-checkbox');
            
            const activeDaily = Array.from(allDaily).filter(cb => !gameState.ignored[cb.id]);
            const activeWeekly = Array.from(allWeekly).filter(cb => !gameState.ignored[cb.id]);
            
            const completedDaily = activeDaily.filter(cb => cb.checked).length;
            const completedWeekly = activeWeekly.filter(cb => cb.checked).length;
            
            const dailyProgress = activeDaily.length > 0 ? Math.round((completedDaily / activeDaily.length) * 100) : 0;
            const weeklyProgress = activeWeekly.length > 0 ? Math.round((completedWeekly / activeWeekly.length) * 100) : 0;
            
            document.getElementById('daily-progress').textContent = dailyProgress + '%';
            document.getElementById('weekly-progress').textContent = weeklyProgress + '%';
            document.getElementById('completed-tasks').textContent = completedDaily + completedWeekly;
            
            // Update streak
            updateStreak(dailyProgress);
        }

        function updateStreak(dailyProgress) {
            const today = new Date().toDateString();
            
            if (dailyProgress === 100) {
                if (gameState.lastCompleteDate !== today) {
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    
                    if (gameState.lastCompleteDate === yesterday.toDateString()) {
                        gameState.streak++;
                    } else if (gameState.lastCompleteDate !== today) {
                        gameState.streak = 1;
                    }
                    
                    gameState.lastCompleteDate = today;
                    sessionStorage.setItem('warframe-streak', gameState.streak.toString());
                    sessionStorage.setItem('warframe-last-complete', today);
                }
            }
            
            document.getElementById('streak-counter').textContent = gameState.streak;
        }

        function updateTaskAppearance(checkbox) {
            const taskItem = checkbox.closest('.task-item, .weekly-task-item');
            if (taskItem) {
                taskItem.classList.toggle('completed', checkbox.checked);
            }
        }

        function toggleIgnore(taskId) {
            const checkbox = document.getElementById(taskId);
            if (!checkbox) return;
            
            const taskItem = checkbox.closest('.task-item, .weekly-task-item');
            const ignoreBtn = taskItem.querySelector('.ignore-btn');
            
            gameState.ignored[taskId] = !gameState.ignored[taskId];
            taskItem.classList.toggle('ignored', gameState.ignored[taskId]);
            ignoreBtn.classList.toggle('ignored', gameState.ignored[taskId]);
            
            updateProgress();
        }

        function updateCounter(taskId, change) {
            const counters = {
                'duviri-circuit': { key: 'duviri', max: 10, element: 'duviri-count' },
                'sp-circuit': { key: 'sp', max: 10, element: 'sp-count' },
                'steel-path-honors': { key: 'spHonors', max: 25, element: 'sp-honors-count' }
            };
            
            const counter = counters[taskId];
            if (!counter) return;
            
            gameState.counters[counter.key] = Math.max(0, Math.min(counter.max, gameState.counters[counter.key] + change));
            document.getElementById(counter.element).textContent = gameState.counters[counter.key];
            
            // Auto-check if at max
            const checkbox = document.getElementById(taskId);
            if (gameState.counters[counter.key] === counter.max && !checkbox.checked) {
                checkbox.checked = true;
                updateTaskAppearance(checkbox);
                updateProgress();
            } else if (gameState.counters[counter.key] < counter.max && checkbox.checked) {
                checkbox.checked = false;
                updateTaskAppearance(checkbox);
                updateProgress();
            }
        }

        function autoCheckEssentials() {
            const essentials = ['daily-login', 'sortie', 'syndicate-daily', 'focus-cap'];
            let checked = 0;
            
            essentials.forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox && !gameState.ignored[id] && !checkbox.checked) {
                    checkbox.checked = true;
                    updateTaskAppearance(checkbox);
                    checked++;
                }
            });
            
            if (checked > 0) {
                updateProgress();
            }
        }

        function resetChecklist() {
            if (confirm('Reset all tasks? This cannot be undone.')) {
                gameState.tasks = {};
                gameState.ignored = {};
                gameState.counters = { duviri: 0, sp: 0, spHonors: 0 };
                
                document.querySelectorAll('.task-checkbox').forEach(cb => {
                    cb.checked = false;
                    const taskItem = cb.closest('.task-item, .weekly-task-item');
                    if (taskItem) {
                        taskItem.classList.remove('completed', 'ignored');
                        const ignoreBtn = taskItem.querySelector('.ignore-btn');
                        if (ignoreBtn) ignoreBtn.classList.remove('ignored');
                    }
                });
                
                document.getElementById('duviri-count').textContent = '0';
                document.getElementById('sp-count').textContent = '0';
                document.getElementById('sp-honors-count').textContent = '0';
                
                updateProgress();
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            updateTimers();
            setInterval(updateTimers, 60000);
            
            document.addEventListener('change', (e) => {
                if (e.target.classList.contains('task-checkbox')) {
                    gameState.tasks[e.target.id] = e.target.checked;
                    updateTaskAppearance(e.target);
                    updateProgress();
                }
            });
            
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('ignore-btn')) {
                    const taskId = e.target.getAttribute('data-task');
                    if (taskId) toggleIgnore(taskId);
                }
                
                if (e.target.classList.contains('counter-btn')) {
                    const taskId = e.target.getAttribute('data-task');
                    const action = e.target.getAttribute('data-action');
                    if (taskId && action) {
                        updateCounter(taskId, action === 'plus' ? 1 : -1);
                    }
                }
            });
            
            updateProgress();
        });
    </script>
</body>
</html>
